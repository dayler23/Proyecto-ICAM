{% extends "layouts/layout.html" %}

{% block title %} {{position.name}} {%endblock%}

{%block content%}
<div class="position-container">
    <div class="position-image">
        {%if position.image != 'null' %}
        <img class="small-image" src="{{position.image.url}}"/>
        {%endif%}
    </div>

    <div class="position-info">
        <h1 class="title">{{position.name}}</h1>
        <span class="date"> {{position.created_at}}</span>

        <p class="content">
            <strong>ÁREA:</strong> {{position.area}}
        </p>
        <p>
            <strong>TIPO DE ACTIVIDAD:</strong> {{position.activity_type|safe}}
        </p>
        <div>
            <button class="btn-eva" type="button" onclick="location.href='{% url 'evaluacion_iluminacion' position.id %}'">ILUMINACION IES</button>
            <button class="btn-eva" type="button">ILUMINACION CTS</button>

            <button class="btn-eva" type="button">RUIDO</button>

        </div>
        </div>


    
</div>
</br>
<hr>

{% if position.lightingevaluation_set.count > 0 %}
<p>Evaluaciones de Iluminacion</p>
<button id="toggleEvaluationsButton" style="background-color: orange; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border: none; border-radius: 12px;">
    <i class="fas fa-angle-down"></i> Mostrar/Ocultar Evaluaciones
</button><div id="evaluations">
{% for evaluation in position.lightingevaluation_set.all %}
    <div class="evaluation-box">
        <p>Fecha: {{ evaluation.date }} - {{ evaluation.period }}</p>

       
        <table class="styled-table">
            <tr>
                <th rowspan="2">Nombre</th>
                <th rowspan="2">Hora de Medición</th>
                <th colspan="3">Mediciones</th>
                <th rowspan="2">Max</th>
                <th rowspan="2">Min</th>
                <th rowspan="2">Promedio</th>
                <th rowspan="2">Parámetro</th>
                <th rowspan="2">Cumplimiento</th>

                {% if evaluation.observations %}
                <th rowspan="2">Observación</th>
                {% endif %}
                
                {% if evaluation.suggestions %}
                <th rowspan="2">Sugerencias</th>
                {% endif %}
            </tr>
            <tr>
                <th>Izq.</th>
                <th>Cen.</th>
                <th>Der.</th>
            </tr>
            <tr>
                <td rowspan="5">{{ position.name }}</td>
                <td rowspan="5">{{ evaluation.time }}</td>
                <td>{{ evaluation.left_1 }}</td>
                <td>{{ evaluation.center_1 }}</td>
                <td>{{ evaluation.right_1 }}</td>
                <td rowspan="5">{{ evaluation.maximum }}</td>
                <td rowspan="5">{{ evaluation.minimum }}</td>
                <td rowspan="5">{{ evaluation.average }}</td>
                <td rowspan="5">{{ evaluation.parameter }}</td>
                <td rowspan="5">{% if evaluation.average > evaluation.parameter %}Cumple{% else %}No cumple{% endif %}</td>
                
                {% if evaluation.observations %}
                <td rowspan="5">{{ evaluation.observations }}</td>
                {% endif %}

                {% if evaluation.suggestions %}
                <td rowspan="5">{{ evaluation.suggestions }}</td>
                {% endif %}
            </tr>
            <tr>
                <td>{{ evaluation.left_2 }}</td>
                <td>{{ evaluation.center_2 }}</td>
                <td>{{ evaluation.right_2 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_3 }}</td>
                <td>{{ evaluation.center_3 }}</td>
                <td>{{ evaluation.right_3 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_4 }}</td>
                <td>{{ evaluation.center_4 }}</td>
                <td>{{ evaluation.right_4 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_5 }}</td>
                <td>{{ evaluation.center_5 }}</td>
                <td>{{ evaluation.right_5 }}</td>
            </tr>
        </table>
    </div>
{% endfor %}
</div >

{% endif %}
<script>
    document.getElementById('toggleEvaluationsButton').addEventListener('click', function() {
        var evaluations = document.getElementById('evaluations');
        if (evaluations.style.display === 'none') {
            evaluations.style.display = 'block';
        } else {
            evaluations.style.display = 'none';
        }
    });
    </script>
{%endblock%}
