{% extends "layouts/layout.html" %}

{% block title %} {{position.name}} {%endblock%}

{%block content%}
<div class="position-container">
    <div class="position-image">
        {%if position.image != 'null' %}
        <img class="small-image" src="{{position.image.url}}"/>
        {%endif%}
    </div>

    <div class="position-info">
        <h1 class="title">{{position.name}}</h1>
        <span class="date"> {{position.created_at}}</span>

        <p class="content">
            <strong>ÁREA:</strong> {{position.area}}
        </p>
        <p>
            <strong>TIPO DE ACTIVIDAD:</strong> {{position.activity_type|safe}}
        </p>
        <div>
            <button class="btn-eva" type="button" onclick="location.href='{% url 'evaluacion_iluminacion' position.id %}'">ILUMINACION IES</button>
            <button class="btn-eva" type="button">ILUMINACION CTS</button>

            <button class="btn-eva" type="button">RUIDO</button>

        </div>
        </div>


    
</div>
</br>
<hr>
<!--
{% if position.lightingevaluation_set.count > 0 %}


<p>Evaluaciones de Iluminacion</p>

<button id="toggleEvaluationsButton" style="background-color: orange; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border: none; border-radius: 12px;">
    <i class="fas fa-angle-down"></i> Mostrar/Ocultar Evaluaciones ILUMINACION
</button><div id="evaluations">
<img src="{% url 'graph_day' position.id %}" alt="Gráfico de día">
<img src="{% url 'graph_night' position.id %}" alt="Gráfico de noche">

    
<div id="dayEvaluations">
    <p>Evaluaciones de Día:</p>
{% for evaluation in position.lightingevaluation_set.all %}

{% if evaluation.period == "Dia" %}
    
    <div class="evaluation-box">
              
        <table class="styled-table">
            <tr>
                <th rowspan="2">Fecha</th>
                <th rowspan="2">Tipo de Iluminacion</th>
                <th rowspan="2">Hora</th>
                <th colspan="3">Mediciones</th>
                <th rowspan="2">Max</th>
                <th rowspan="2">Min</th>
                <th rowspan="2">Promedio</th>
                <th rowspan="2">Parámetro</th>
                <th rowspan="2">Cumplimiento</th>

                {% if evaluation.observations %}
                <th rowspan="2">Observación</th>
                {% endif %}
                
                {% if evaluation.suggestions %}
                <th rowspan="2">Sugerencias</th>
                {% endif %}
            </tr>
            <tr>
                <th>Izq.</th>
                <th>Cen.</th>
                <th>Der.</th>
            </tr>
            <tr>
                <td rowspan="5">{{ evaluation.date |date:"d/m/Y"}}</td>
                <td rowspan="5">{{ evaluation.type }}</td>
                <td rowspan="5">{{ evaluation.time }}</td>
                <td>{{ evaluation.left_1 }}</td>
                <td>{{ evaluation.center_1 }}</td>
                <td>{{ evaluation.right_1 }}</td>
                <td rowspan="5">{{ evaluation.maximum }}</td>
                <td rowspan="5">{{ evaluation.minimum }}</td>
                <td rowspan="5">{{ evaluation.average }}</td>
                <td rowspan="5">{{ evaluation.parameter }}</td>
                <td rowspan="5">{% if evaluation.average > evaluation.parameter %}Cumple{% else %}No cumple{% endif %}</td>
                
                {% if evaluation.observations %}
                <td rowspan="5">{{ evaluation.observations }}</td>
                {% endif %}

                {% if evaluation.suggestions %}
                <td rowspan="5">{{ evaluation.suggestions }}</td>
                {% endif %}
            </tr>
            <tr>
                <td>{{ evaluation.left_2 }}</td>
                <td>{{ evaluation.center_2 }}</td>
                <td>{{ evaluation.right_2 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_3 }}</td>
                <td>{{ evaluation.center_3 }}</td>
                <td>{{ evaluation.right_3 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_4 }}</td>
                <td>{{ evaluation.center_4 }}</td>
                <td>{{ evaluation.right_4 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_5 }}</td>
                <td>{{ evaluation.center_5 }}</td>
                <td>{{ evaluation.right_5 }}</td>
            </tr>
        </table>
    </div>
    {% endif %}
{% endfor %}
</div>


<div id="nightEvaluations">
    <p>Evaluaciones de Noche:</p>
{% for evaluation in position.lightingevaluation_set.all %}
    {% if evaluation.period == "Noche" %}
    
       
    <div class="evaluation-box">
        <p>Fecha: {{ evaluation.date }} - {{ evaluation.period }}</p>

       
        <table class="styled-table">
            <tr>
                <th rowspan="2">Nombre</th>
                <th rowspan="2">Hora</th>
                <th colspan="3">Mediciones</th>
                <th rowspan="2">Max</th>
                <th rowspan="2">Min</th>
                <th rowspan="2">Promedio</th>
                <th rowspan="2">Parámetro</th>
                <th rowspan="2">Cumplimiento</th>

                {% if evaluation.observations %}
                <th rowspan="2">Observación</th>
                {% endif %}
                
                {% if evaluation.suggestions %}
                <th rowspan="2">Sugerencias</th>
                {% endif %}
            </tr>
            <tr>
                <th>Izq.</th>
                <th>Cen.</th>
                <th>Der.</th>
            </tr>
            <tr>
                <td rowspan="5">{{ position.name }}</td>
                <td rowspan="5">{{ evaluation.time }}</td>
                <td>{{ evaluation.left_1 }}</td>
                <td>{{ evaluation.center_1 }}</td>
                <td>{{ evaluation.right_1 }}</td>
                <td rowspan="5">{{ evaluation.maximum }}</td>
                <td rowspan="5">{{ evaluation.minimum }}</td>
                <td rowspan="5">{{ evaluation.average }}</td>
                <td rowspan="5">{{ evaluation.parameter }}</td>
                <td rowspan="5">{% if evaluation.average > evaluation.parameter %}Cumple{% else %}No cumple{% endif %}</td>
                
                {% if evaluation.observations %}
                <td rowspan="5">{{ evaluation.observations }}</td>
                {% endif %}

                {% if evaluation.suggestions %}
                <td rowspan="5">{{ evaluation.suggestions }}</td>
                {% endif %}
            </tr>
            <tr>
                <td>{{ evaluation.left_2 }}</td>
                <td>{{ evaluation.center_2 }}</td>
                <td>{{ evaluation.right_2 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_3 }}</td>
                <td>{{ evaluation.center_3 }}</td>
                <td>{{ evaluation.right_3 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_4 }}</td>
                <td>{{ evaluation.center_4 }}</td>
                <td>{{ evaluation.right_4 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_5 }}</td>
                <td>{{ evaluation.center_5 }}</td>
                <td>{{ evaluation.right_5 }}</td>
            </tr>
        </table>
    </div>
    {% endif %}
{% endfor %}
</div>
{% endif %}




</div >


<script>
    document.getElementById('toggleEvaluationsButton').addEventListener('click', function() {
        var evaluations = document.getElementById('evaluations');
        if (evaluations.style.display === 'none') {
            evaluations.style.display = 'block';
        } else {
            evaluations.style.display = 'none';
        }
    });
    </script>-->
    <button id="toggleAllEvaluationsButton" style="background-color: orange; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border: none; border-radius: 12px;">
        <i class="fas fa-angle-down"></i> Mostrar/Ocultar Evaluaciones ILUMINACION
    </button><div id="evaluations">
    <div id="evaluationspt">

    {% if evaluations %}
    <button id="toggleDayEvaluationsButton">Mostrar/Ocultar Evaluaciones de Día</button>
    <button id="toggleNightEvaluationsButton">Mostrar/Ocultar Evaluaciones de Noche</button>
        <h2>Evaluaciones de Iluminación</h2>
    
        <div id="dayEvaluations">
            <h3>Evaluación de Dís</h3>

        {% for evaluation in evaluations|dictsort:"date" %}
            {% if evaluation.period == "Dia" %}
                <div class="evaluation">

                    <div class="evaluation-box">
              
                        <table class="styled-table">
                            <tr>
                                <th rowspan="2">Fecha</th>
                                <th rowspan="2">Tipo de Iluminacion</th>
                                <th rowspan="2">Hora</th>
                                <th colspan="3">Mediciones</th>
                                <th rowspan="2">Max</th>
                                <th rowspan="2">Min</th>
                                <th rowspan="2">Promedio</th>
                                <th rowspan="2">Parámetro</th>
                                <th rowspan="2">Cumplimiento</th>
                
                                {% if evaluation.observations %}
                                <th rowspan="2">Observación</th>
                                {% endif %}
                                
                                {% if evaluation.suggestions %}
                                <th rowspan="2">Sugerencias</th>
                                {% endif %}
                            </tr>
                            <tr>
                                <th>Izq.</th>
                                <th>Cen.</th>
                                <th>Der.</th>
                            </tr>
                            <tr>
                                <td rowspan="5">{{ evaluation.date |date:"d/m/Y"}}</td>
                                <td rowspan="5">{{ evaluation.type }}</td>
                                <td rowspan="5">{{ evaluation.time }}</td>
                                <td>{{ evaluation.left_1 }}</td>
                                <td>{{ evaluation.center_1 }}</td>
                                <td>{{ evaluation.right_1 }}</td>
                                <td rowspan="5">{{ evaluation.maximum }}</td>
                                <td rowspan="5">{{ evaluation.minimum }}</td>
                                <td rowspan="5">{{ evaluation.average }}</td>
                                <td rowspan="5">{{ evaluation.parameter }}</td>
                                <td rowspan="5">{% if evaluation.average > evaluation.parameter %}Cumple{% else %}No cumple{% endif %}</td>
                                
                                {% if evaluation.observations %}
                                <td rowspan="5">{{ evaluation.observations }}</td>
                                {% endif %}
                
                                {% if evaluation.suggestions %}
                                <td rowspan="5">{{ evaluation.suggestions }}</td>
                                {% endif %}
                            </tr>
                            <tr>
                                <td>{{ evaluation.left_2 }}</td>
                                <td>{{ evaluation.center_2 }}</td>
                                <td>{{ evaluation.right_2 }}</td>
                            </tr>
                            <tr>
                                <td>{{ evaluation.left_3 }}</td>
                                <td>{{ evaluation.center_3 }}</td>
                                <td>{{ evaluation.right_3 }}</td>
                            </tr>
                            <tr>
                                <td>{{ evaluation.left_4 }}</td>
                                <td>{{ evaluation.center_4 }}</td>
                                <td>{{ evaluation.right_4 }}</td>
                            </tr>
                            <tr>
                                <td>{{ evaluation.left_5 }}</td>
                                <td>{{ evaluation.center_5 }}</td>
                                <td>{{ evaluation.right_5 }}</td>
                            </tr>
                        </table>
                    </div>                </div>
            {% endif %}
        {% endfor %}
        </div>
    
        <div id="nightEvaluations">
            <h3>Evaluación de Noche</h3>
        {% for evaluation in evaluations|dictsort:"date" %}
            {% if evaluation.period == "Noche" %}
                <div class="evaluation">
                    
    <div class="evaluation-box">
              
        <table class="styled-table">
            <tr>
                <th rowspan="2">Fecha</th>
                <th rowspan="2">Tipo de Iluminacion</th>
                <th rowspan="2">Hora</th>
                <th colspan="3">Mediciones</th>
                <th rowspan="2">Max</th>
                <th rowspan="2">Min</th>
                <th rowspan="2">Promedio</th>
                <th rowspan="2">Parámetro</th>
                <th rowspan="2">Cumplimiento</th>

                {% if evaluation.observations %}
                <th rowspan="2">Observación</th>
                {% endif %}
                
                {% if evaluation.suggestions %}
                <th rowspan="2">Sugerencias</th>
                {% endif %}
            </tr>
            <tr>
                <th>Izq.</th>
                <th>Cen.</th>
                <th>Der.</th>
            </tr>
            <tr>
                <td rowspan="5">{{ evaluation.date |date:"d/m/Y"}}</td>
                <td rowspan="5">{{ evaluation.type }}</td>
                <td rowspan="5">{{ evaluation.time }}</td>
                <td>{{ evaluation.left_1 }}</td>
                <td>{{ evaluation.center_1 }}</td>
                <td>{{ evaluation.right_1 }}</td>
                <td rowspan="5">{{ evaluation.maximum }}</td>
                <td rowspan="5">{{ evaluation.minimum }}</td>
                <td rowspan="5">{{ evaluation.average }}</td>
                <td rowspan="5">{{ evaluation.parameter }}</td>
                <td rowspan="5">{% if evaluation.average > evaluation.parameter %}Cumple{% else %}No cumple{% endif %}</td>
                
                {% if evaluation.observations %}
                <td rowspan="5">{{ evaluation.observations }}</td>
                {% endif %}

                {% if evaluation.suggestions %}
                <td rowspan="5">{{ evaluation.suggestions }}</td>
                {% endif %}
            </tr>
            <tr>
                <td>{{ evaluation.left_2 }}</td>
                <td>{{ evaluation.center_2 }}</td>
                <td>{{ evaluation.right_2 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_3 }}</td>
                <td>{{ evaluation.center_3 }}</td>
                <td>{{ evaluation.right_3 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_4 }}</td>
                <td>{{ evaluation.center_4 }}</td>
                <td>{{ evaluation.right_4 }}</td>
            </tr>
            <tr>
                <td>{{ evaluation.left_5 }}</td>
                <td>{{ evaluation.center_5 }}</td>
                <td>{{ evaluation.right_5 }}</td>
            </tr>
        </table>
    </div><!-- Aquí puedes mostrar los demás campos de la evaluación -->
                </div>
            {% endif %}
        {% endfor %}
        </div>
    {% else %}
        <p>No hay evaluaciones de iluminación para esta posición.</p>
    {% endif %}
        

<script>
    document.getElementById('toggleAllEvaluationsButton').addEventListener('click', function() {
        var evaluations = document.getElementById('evaluationspt');
        if (evaluations.style.display === 'none') {
            evaluations.style.display = 'block';
        } else {
            evaluations.style.display = 'none';
        }
    });

    document.getElementById('toggleDayEvaluationsButton').addEventListener('click', function() {
        var dayEvaluations = document.getElementById('dayEvaluations');
        if (dayEvaluations.style.display === 'none') {
            dayEvaluations.style.display = 'block';
        } else {
            dayEvaluations.style.display = 'none';
        }
    });

    document.getElementById('toggleNightEvaluationsButton').addEventListener('click', function() {
        var nightEvaluations = document.getElementById('nightEvaluations');
        if (nightEvaluations.style.display === 'none') {
            nightEvaluations.style.display = 'block';
        } else {
            nightEvaluations.style.display = 'none';
        }
    });
</script>
{%endblock%}
